"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var s=0,r=function(){};return{s:r,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,i=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return o=t.done,t},e:function(t){i=!0,n=t},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw n}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}var setupGame=function(t){var e,a="<div>",s=!1,r=_createForOfIteratorHelper(t);try{for(r.s();!(e=r.n()).done;){" "===e.value?(s=!0,a+="</div><div>"):(a+='<span class="'.concat(s?"has-space":"",'"></span>'),s=!1)}}catch(t){r.e(t)}finally{r.f()}a+="</div>",$(".guessbox").html(a)};$(function(){var t,e=phrases[2].toUpperCase(),a=e.replaceAll(" ",""),s=a.length,r=0,n=0,o=1,i=!1,u=function(){i||(clearTimeout(t),t=void 0,setStats(grades.F),c(),i=!0)},c=function(){$(".error-popup h2").addClass(grades.F),$(".error-popup p").text(e),displayStats($(".error-popup .stats")),$(".error-popup").show()},p=function(t){$(".win-popup h2").addClass(t),displayStats($(".win-popup .stats")),$(".win-popup").show()},l=function e(o){var i=pattern[r%pattern.length];o||setGameState(r);var c=a.indexOf(i);if(-1!=c){a=a.replace(i,i.toLowerCase());var p=$(".guessbox span").get(c);$(p).text(i),r++,updateProgress(++n,s),o||(void 0!==t&&clearTimeout(t),t=setTimeout(function(){return e(o)},LETTER_TIMER))}else r++,e(o);n==s&&u()};setupGame(e),initProgress(s);for(var d=getTodaysStat();r<=d.counter;)l(!0);d.isComplete?(d.didWin?p(d.grade):c(grades.F),$(".guess-now").prop("disabled",!0)):d.guessCnt?(o=d.guessCnt,onGuess(o)):($(".popup.instructions").show(),$(".popup.instructions .play-now").on("click",function(){d.isComplete||d.guessCnt||void 0!==t&&clearTimeout(t),t=setTimeout(function(){return l()},LETTER_TIMER),updateProgress(n,s),$(".popup.instructions").hide()})),$(".guess-now").on("click",function(){onGuess(),clearTimeout(t),t=void 0}),$(".guess-check").on("click",function(){var t=onGuessSubmit(a);t?function(){if(!i){var t=n/s*100,e=getGrade(t+=5*(o-1));setStats(e),p(e),i=!0}}():!1===t&&(o++,$(".guess-chances span").slice(0,(o||1)-1).addClass("lost"),updateProgressFromWrongGuess(n,s,o),setGameStateGuess(o),$(".guessbox").addClass("wrong-guess"),setTimeout(function(){$(".guessbox").removeClass("wrong-guess"),$(".guessbox input").val(""),$(".guessbox input").first().focus(),o>MAX_GUESS&&u()},1e3))}),$(".main-section").on("keyup","input[type='text']",function(t){var e=$(t.target).closest(".guessbox").find("input[type='text']");8==t.keyCode?e.eq(Math.max(e.index(t.target)-1,0)).val("").focus():e.eq(e.index(t.target)+1).focus()})});var setGameState=function(t){localStorage.setItem(items.GAME_STATE,'{ "counter": '.concat(t," }"))},getTodaysStat=function(){var t=localStorage.getItem(items.LAST_PLAYED),e=getTodaysDt();return t!=e&&(localStorage.setItem(items.LAST_PLAYED,e),localStorage.removeItem(items.GAME_STATE)),getObjectItem(items.GAME_STATE)},getObjectItem=function(t){var e=localStorage.getItem(t)||"{}";return $.parseJSON(e)},onGuess=function(t){setToGuessMode(),$(".progress-bar-timer").addClass("hide"),$(".guess-chances span").slice(0,(t||1)-1).addClass("lost"),setGameStateGuess(t||1),$(".guessbox").find("span").each(function(){$(this).text().trim().length||$(this).html("<input type='text' maxlength='1'>")}),$(".guessbox input").first().focus()},onGuessSubmit=function(t){var e="",a=!1;if($(".guessbox span").each(function(){$(this).find("input").length?(""===$(this).find("input").val()&&($(this).find("input[type='text']").each(function(t,e){$(e).val()||$(e).addClass("empty"),setTimeout(function(){$(".guessbox input.empty").first().focus(),$(".guessbox input").removeClass("empty")},300)}),a=!0),e+=$(this).find("input").val()||""):e+=$(this).text()||""}),!a)return e.toUpperCase()==t.toUpperCase()},setToGuessMode=function(){$(".main-section").addClass("guess-mode"),$(".guess-now").remove()},setGameStateGuess=function(t){var e=getObjectItem(items.GAME_STATE);e.guessCnt=t,localStorage.setItem(items.GAME_STATE,JSON.stringify(e))},setStats=function(t){$(".guess-popup").hide();var e=getObjectItem(items.GAME_STATE);e.didWin=t!=grades.F,e.isComplete=!0,e.grade=t,localStorage.setItem(items.GAME_STATE,JSON.stringify(e));var a=getObjectItem(items.GRADES),s=a[t]||0;a[t]=s+1,localStorage.setItem(items.GRADES,JSON.stringify(a))},getGrade=function(t){return t>=0&&t<=40?grades.A:t>40&&t<=70?grades.B:t>70&&t<=90?grades.C:grades.D},displayStats=function(t){var e=getObjectItem(items.GRADES),a=Object.values(e),s=Math.max.apply(Math,_toConsumableArray(a))||5,r='\n        <div class="chart">\n            <span data-grade="'.concat(grades.A,'">&nbsp;</span>\n            <span data-grade="').concat(grades.B,'">&nbsp;</span>\n            <span data-grade="').concat(grades.C,'">&nbsp;</span>\n            <span data-grade="').concat(grades.D,'">&nbsp;</span>\n            <span data-grade="').concat(grades.F,'">&nbsp;</span>\n        </div>\n        <div class="chart-labels">\n            <span class="').concat(grades.A,'"></span>\n            <span class="').concat(grades.B,'"></span>\n            <span class="').concat(grades.C,'"></span>\n            <span class="').concat(grades.D,'"></span>\n            <span class="').concat(grades.F,'"></span>\n        </div>\n    ');t.html(r),t.find(".chart span").each(function(t,a){var r=$(a).attr("data-grade"),n=(e[r]||0)/s*100;$(a).css("height","".concat(n,"px")),e[r]&&$(a).text(e[r])})},updateProgress=function(t,e){var a=t/e*100,s=Math.min((t+1)/e*100,100);$(".progress-bar-cover").css("width","".concat(a,"%")),$(".progress-bar-timer").css("width","".concat(s,"%"))},updateProgressFromWrongGuess=function(t,e,a){var s=t/e*100;s+=5*(a-1),$(".progress-bar-cover").css("width","".concat(s,"%"))},initProgress=function(t){for(var e=1/t*100,a=0;a<t-1;a++)$(".progress-bar").append('<small class="divider" style="left:'.concat(e*(a+1),'%"></small>'))},getTodaysDt=function(){var t=new Date;return"".concat(t.getMonth()+1,"/").concat(t.getDate(),"/").concat(t.getFullYear())},randomizeItems=function(t){return t.map(function(t){return{sort:Math.random(),value:t}}).sort(function(t,e){return t.sort-e.sort}).map(function(t){return t.value})},pattern=["D","L","Z","F","E","K","B","O","P","V","T","G","S","A","C","U","N","I","H","R","Y","J","M","X","Q","W"],phrases=["A great place to unwind","A hop skip and a jump","A glimpse into the future","A mile a minute","Based on actual events"],items={LAST_PLAYED:"last-played-date",GAME_STATE:"game-state",GRADES:"grades"},grades={A:"grade-a",B:"grade-b",C:"grade-c",D:"grade-d",F:"grade-f"},MAX_GUESS=3,LETTER_TIMER=5e3,GUESS_PENALTY=5;
